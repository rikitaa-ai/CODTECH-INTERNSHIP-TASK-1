/* USING JUPYTER NOTEBOOK*/

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

df = pd.read_csv(r"C:\Users\beher\Downloads\mall_customer dataset\Mall_Customers.csv")

print(df.columns)

print(df.head()) 

print(df.info())

print(df.describe())

print(df.replace([np.inf, -np.inf], np.nan).isnull().sum())
df.replace([np.inf, -np.inf], np.nan, inplace=True)
df.dropna(inplace=True)

plt.figure(figsize=(10,6))
sns.histplot(df['Annual Income (k$)'], bins=20, kde=True)  
plt.title("Distribution of Annual Income")
plt.xlabel("Annual Income (k$)")
plt.ylabel("Frequency")
plt.show()

plt.figure(figsize=(10, 6))
sns.histplot(df['Spending Score (1-100)'], bins=20, kde=True)
plt.title("Distribution of Spending Score")
plt.xlabel("Spending Score (1-100)")
plt.ylabel("Frequency")
plt.show()

plt.figure(figsize=(10, 6))
sns.scatterplot(x='Annual Income (k$)', y='Spending Score (1-100)', data=df, hue='Gender', palette='deep')
plt.title("Scatter Plot of Annual Income vs. Spending Score")
plt.xlabel("Annual Income (k$)")
plt.ylabel("Spending Score (1-100)")
plt.legend(title='Gender')  
plt.show()

numerical_df = df.select_dtypes(include=[np.number])  
corr_matrix = numerical_df.corr() 
plt.figure(figsize=(12, 8))
sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', linewidths=0.5)
plt.title("Correlation Matrix Heatmap")
plt.show()

df.replace([np.inf, -np.inf], np.nan, inplace=True)
print("Number of NaN values in the DataFrame:")
print(df.isna().sum())

pair_plot = sns.pairplot(numerical_df, hue='Age', palette='deep')  
pair_plot.fig.suptitle("Pair Plot of Numerical Features", y=1.02)
plt.show()  
